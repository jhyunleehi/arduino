

# 기후 위기 대응

[![스스로 멸먕의 길을 걷는 인류](https://user-images.githubusercontent.com/13324737/178131419-54e8ff76-b405-4a2c-b9e3-b6d80140ef77.png)](https://www.youtube.com/embed/sMjAroVIp0k)





## Arduino

AVR 기반의 마이크로컨트롤러 Wiring에서 파생한 프로젝트다.

영어로 '아두이노', 이탈리아어로 '아르두이노'라고 읽는다. 영어권의 영향이 강한 국내에서 많이 사용되는 명칭은 아두이노. 이탈리아어로 '강력한 친구'라는 뜻이라는 듯. 2005년 이탈리아의 Massimo Banzi와 David Cuartielles가 처음 개발하였다. 개발자 Massimo Banzi가 직접 저술한 <Getting Started with Arduino>(번역명 <손에 잡히는 아두이노>)를 필두로 많은 입문서들이 나와 있다.

비관련자를 위해 쉽게 설명하자면, 간단한 초소형 컴퓨터 기판 에 이런저런 기능을 할 수 있도록 프로그래밍을 하여 다양한 기계나 작업, 작품에 써먹는 경우가 많은데, 그것들 중에서도 교육에 특화되어 특히 더 쉬운 사용법을 자랑하는 시스템이라 보면 간단하다. 
* 아두이노와 관련된 작품들을 보고싶다면 추천한다.
* http://www.instructables.com/tag/type-id/category-technology



우노 R3 버전으로 2013년 기준 레퍼런스 보드이자 가장 보편적으로 사용되는 보드다. 사용하는 마이크로컨트롤러는 ATMega328P로 16MHz로 동작하고 프로그램 저장용 플래시 32KB를 내장한 프로세서이다.

임베디드 개발 경험이 전혀 없는 사람을 위해 개발된 교육용 플랫폼이기 때문에 프로그램을 작성하고 보드에 프로그램을 올리는 과정을 단순화하여 다루기 쉽게 되어 있다.





#### Atmel에서 만든 범용 RISC 마이크로컨트롤러. 

* CPU, ROM, RAM, 플래시 메모리, ADC, DAC, GPIO가 다 들어 있다.
* ISP(In-System Programming) 인터페이스를 갖추고 있어서 별도의 롬 라이터 없이 PC에서 프린터 포트나 시리얼 포트, USB 인터페이스에 연결하는 ISP 장비를 통해 손쉽게 프로그램을 짜 넣을 수 있다
* 저렴한 가격에 ROM, RAM 걱정 없이 프로그램을 넣을 수 있기 때문에 많은 대학교의 전자공학과에서 마이크로컨트롤러나 임베디드 시스템과 관련된 과목에서 AVR을 대상으로 강의하는 경우가 많다.

* 겨우 8비트급 마이크로컨트롤러임에도 불구하고 RISC를 표방하고 있다.
* 전기밥솥, 엘리베이터 제어, 자동 판매기 등 높은 성능이 전혀 필요 없고 신뢰성이 필요한 제어 장치 부분은 앞으로도 계속 8비트 마이크로컨트롤러가 사용될 것이다. 
* 각종 용도별 어셈블리 및 C 소스 프로그램이 온 천지에 널려있다... Arduino 플랫폼 중 가장 기본이 되고 많이 사용되는 아두이노 우노 또한 이 AVR 기반이다. 커스텀 키보드에도 USB를 지원하는 ATMega32 계열 MCU가 자주 사용된다.

##### ATMEGA128 

AVR도 여러 모델이 있지만 그 중 ATMEGA128이 가장 인기가 좋다. 

* 가격, 기능, 확장성 등의 적절함은 말할 것도 없고 예제 코드가 정말 넘쳐난다. 
* 프로세서만 단독으로 구매하면 보통 1.5만원 미만이고 외부 장치 연결을 위해 이런저런 포트들을 덕지덕지 달고 있는 모듈 타입도 10만원을 채 넘지 않는다. 
* 그냥 사다가 RS232C 포트나 UART 포트에 꽂은 뒤 매뉴얼에 적힌 코드를 그대로 복붙해서 다운로드만 해도 의도한 대로 동작하는 모듈들이 많다. 이 정도로 예제 코드가 넘쳐나는데 ATMEGA128로 원하는 것을 못 만든다면… 애초에 ATMEGA128을 제대로 다룰 줄 모르든가 아니면 ATMEGA128 정도의 프로세서로는 만들 수 없는 물건일 가능성이 높다. 
* 가장 큰 장점은 전기적 특성이 매우 강하다는 것. 핀이 공급하거나 받을수 있는 전류 한계치가 다른 마이크로컨트롤러에 비해 높다. I/O에서 감당 가능한 전류가 40mA로 다른 마이크로컨트롤러들의 경우 이것의 절반이거나 10분의 1 정도밖에 안되는 경우도 허다하다. 
* 물론 8비트 마이크로컨트롤러인 만큼 연산 능력이나 클럭 속도, 메모리 어드레스 영역은 상당히 제한된다. AVR 시리즈 중 고급형에 해당하는 ATMega급의 최대 동작 속도가 20MHz에 머물고 있으며, 그나마 이는 일부 모델만 해당되고 대부분은 16MHz가 한계이다. 대부분의 경우 FPU가 없을 뿐만 아니라 32비트 단정도 실수를 제대로 처리하기에는 워드 길이가 8비트로 크게 제약되는 나머지 소프트웨어적인 실수 연산 처리도 쉽지 않으므로 복잡한 수학 연산 성능은 거의 없다고 생각하는 편이 좋다. 
* 그러나 8비트 마이크로컨트롤러의 특성 상 구조가 간단하다. 32비트급 이상의 고속 MPU에서 주로 볼 수 있는 CPU 코어에 관련된 MMU나 DRAM 컨트롤러 등의 여러 장치들의 특성을 사전에 익힐 필요가 없고 OS를 끼고 돌아가는 경우가 적기 때문에 그에 관련된 내용도 따로 스터디할 필요가 없다. 
* 즉 부팅하고 바로 유저가 작성한 코드로 점프하면 되기 때문에 다루기 쉽다는 것이지, C 코드 문법이 쉽다는 의미가 아니다. 유지보수가 간단하며, I/O핀이 전기적으로 강인한 경우가 많고, 워낙 오랫동안 사용되어 오면서 검증된 안정성과 무엇보다도 32비트급 마이크로컨트롤러에 비해 단가가 매우 싸기 때문에 단순 제어 분야에서는 현업에서도 여전히 널리 사용되고 있다.



#### AVR란?

ATMEL사가 개발한 AVR은 현재 8비트 AVR과 32비트 AVR을 제공하고 있는 마이크로 컨트롤러이다. AVR의 다양한 명령과 쉬운 구조를 띄고 있어 마이크로 컨트로로러 이해하는데 쉽게 접근할 수 있으며, 가격이 저렴하고 응용하기 쉬워 산업시장에서도 많이 사용되어 지고 있다.

*  AVR은 1개의 클록 사이클에 1개의 명령을 처리 할 수 있으며, 1.8V에서 5.5V까지 어느 전압이든 동작 시킬 수 있다. 
* picoPower 기술이 적용된 제품의 경우 저 전력 설계가 가능하고, 32개의 범용 레지스터와 RISC 구조의 디자인은 C언어에 적합하여 제품을 빠르게 개발하는데 도움이 된다. 
* 재부에 플래시 메모리를 제공함으로서 새로 개발되는 제품의 크기를 줄일 수 있고, 제품의 크기가 줄면서 원가 절감에도 도움이 된다. 
*  6핀 또는 10핀 인터페이스로 제공되는 ISP(In-System Programming)기능이나 JTAG 기능은 쉽게 제품을 개발하는데 도움이 된다.



#### 아두이노 주의 사항

* 8비트 임베디드 시스템 프로그래밍에 있어서는 프로그램 최적화에 매우 신경써야 한다. 마이크로 컨트롤러같이 메모리 리소스가 크게 제한되는 장치에서 프로그래밍을 할 경우 항상 주의해야 하는 부분이다. 아두이노는 성능이 매우 떨어지기 때문에 다른 기계에서는 문제없을만한 부분이 유독 문제를 일으키기도 한다. 
* C에서 함수가 중복 호출될 경우 스택 오버플로를 일으키면서 장비가 정지될 수 있다. 예를 들어, 장비가 정지했는데 개발 도중에 동작 테스트를 위해 추가한 Serial.print();문 몇 줄을 지워보니 추가한 코드들이 갑자기 정상적으로 돌아가는 경우도 있다. 이 때문에 deploy판에 디버그용 print를 지우고 보내는 것은 기본이다. 하드웨어 시리얼로 블루투스 통신을 한다던지 등 예외적인 경우에만 놔두는 것이 좋다.
* 아두이노 자체의 성능 제약을 피하려면, 라즈베리 파이 같은 다른 장치를 연결해 연산은 다른 데에서 처리하고, 아두이노는 센서나 액추에이터 등을 관리하는 기계로만 사용하는 게 나을 수도 있다. 
* 아두이노에 Firmata라는 펌웨어를 올리면 Firmata 프로토콜을 통해서 외부에서 아두이노를 컨트롤할 수 있게 된다. Processing을 비롯해 꽤 많은 언어를 이용하여 Firmata로 아두이노를 컨트롤할 수 있으니 이쪽을 알아보는 것도 괜찮다. 이걸 잘 활용하면 아두이노에는 최소한의 코드만 올리고 연산 부하가 큰 나머지 부분은 PC나 라즈베리 파이 같은 별도의 장치의 자원을 사용하여 돌리는 식으로 동작시키는 게 가능하다. 아두이노 자체로는 센서값 읽어서 판단하고 트윗올리는 것만 짜넣어도 빡빡한 경우가 있으니 판을 크게 벌일 거라면 다른 장치를 사용해 통제하는 걸 고려해보자. 
* 판이 크지 않다고 하더라도 외부 컴퓨터-아두이노 사이의 통신이 필요한 프로젝트인 경우, 시리얼 통신으로 메시지를 주고받는 것보다 자연스러운 형태로 코딩이 가능하므로 Firmata를 적극 사용해보는 것도 괜찮다. 이런 과정이 번거롭다면 내부 플래시와 램 용량이 크게 늘어난 아두이노 두에 혹은 2016년 기준 최신형인 제로나 전술한 101 또는 Primo, Star를 쓰는 것도 좋은 선택.
* 아두이노 IDE에 내장된 ArduinoISP 예제를 이용하여 다른 아두이노에 업로드를 할 경우, ArduinoISP로 업로드받은 아두이노는 부트로더가 지워진다! 그렇기 때문에 웬만하면 USB TO UART 컨버터를 이용해 업로드하자.
* 아두이노 컴파일러에서 소스 코드를 보드에 업로드 할 때, 우분투 같은 리눅스로 하는 것이 윈도우로 하는 것 보다 훨씬 빠르다.



### [ARDUINO 개념](https://yozm.wishket.com/magazine/detail/234/)

